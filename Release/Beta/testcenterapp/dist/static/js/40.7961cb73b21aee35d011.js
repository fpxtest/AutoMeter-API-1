webpackJsonp([40],{OHFj:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("Dd8w"),s=e.n(i),n=e("nAq6"),p=e("XcM5"),r=e("W+bg"),l=e("0xDb"),o=e("NYxO"),m={filters:{statusFilter:function(a){return{published:"success",draft:"gray",deleted:"danger"}[a]}},data:function(){return{paralabel:"参数(英文逗号隔开)",keyholder:"例如key1,key2,key3",itemKey:null,tmpapiname:null,tmpdeployunitname:null,apiparamsList:[],apiList:[],paramsapiList:[],deployunitList:[],paramlist:[],listLoading:!1,apiQuery:{deployunitname:""},total:0,dialogStatus:"add",dialogFormVisible:!1,textMap:{updateRole:"修改api参数",update:"修改api参数",add:"添加api参数"},btnLoading:!1,tmpapiparams:{id:"",apiid:"",deployunitid:"",apiname:"",deployunitname:"",propertytype:"",keyname:"",keynamebak:"",creator:""},search:{page:1,size:10,apiname:null,deployunitname:null}}},computed:s()({},Object(o.b)(["name","sidebar","avatar"])),created:function(){this.getapiparamsList(),this.getdepunitLists()},methods:{unix2CurrentTime:l.b,getapiparamsList:function(){var a=this;this.search.deployunitname=this.tmpdeployunitname,this.search.apiname=this.tmpapiname,this.listLoading=!0,Object(n.f)(this.search).then(function(t){a.apiparamsList=t.data.list,a.total=t.data.total,a.listLoading=!1}).catch(function(t){a.$message.error("加载apiparams列表失败")})},getdepunitLists:function(){var a=this;Object(p.e)().then(function(t){a.deployunitList=t.data,console.log(a.deployunitList)}).catch(function(t){a.$message.error("加载发布单元列表失败")})},selectChanged:function(a){var t=this;this.apiList=null,this.search.apiname="",this.apiQuery.deployunitname=a,Object(r.d)(this.apiQuery).then(function(a){t.apiList=a.data,t.total=a.data.total}).catch(function(a){t.$message.error("加载api列表失败")})},paratypeselectChanged:function(a){this.tmpapiparams.keyname="","Body"===a?(this.paralabel="参数(支持Json，Xml)",this.keyholder='例如：\n {\n  "id": "",\n  "enviromentname": "teste2",\n  "envtype": "功能",\n  "memo": "",\n  "creator": "admin"\n}'):(this.paralabel="参数(英文逗号隔开)",this.keyholder="例如： key1,key2,key3")},paramdeployselectChanged:function(a){for(var t=this,e=0;e<this.deployunitList.length;e++)this.deployunitList[e].deployunitname===a&&(this.tmpapiparams.deployunitid=this.deployunitList[e].id);this.paramsapiList=null,this.tmpapiparams.apiname="",this.tmpapiparams.propertytype="",this.tmpapiparams.keyname="",this.apiQuery.deployunitname=a,Object(r.d)(this.apiQuery).then(function(a){t.paramsapiList=a.data,t.total=a.data.total}).catch(function(a){t.$message.error("加载api列表失败")})},apinameselectChanged:function(a){this.tmpapiparams.propertytype="",this.tmpapiparams.keyname="";for(var t=0;t<this.paramsapiList.length;t++)if(this.paramsapiList[t].apiname===a)if(this.paramlist=[],this.tmpapiparams.apiid=this.paramsapiList[t].id,console.log("====================================="),console.log(this.paramsapiList[t].visittype),"get"===this.paramsapiList[t].visittype){this.paramlist.push({value:"Header"}),this.paramlist.push({value:"Params"}),console.log(this.paramlist)}else{console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>");this.paramlist.push({value:"Header"}),this.paramlist.push({value:"Params"}),this.paramlist.push({value:"Body"}),console.log(this.paramlist)}},searchBy:function(){var a=this;this.search.page=1,this.listLoading=!0,Object(n.f)(this.search).then(function(t){a.itemKey=Math.random(),a.apiparamsList=t.data.list,a.total=t.data.total}).catch(function(t){a.$message.error("搜索失败")}),this.listLoading=!1,this.btnLoading=!1,this.tmpapiname=this.search.apiname,this.tmpdeployunitname=this.search.deployunitname},handleSizeChange:function(a){this.search.page=1,this.search.size=a,this.getapiparamsList()},handleCurrentChange:function(a){this.search.page=a,this.getapiparamsList()},getIndex:function(a){return(this.search.page-1)*this.search.size+a+1},showAddapiparamsDialog:function(){this.paralabel="参数",this.dialogFormVisible=!0,this.dialogStatus="add",this.tmpapiparams.id="",this.tmpapiparams.keyname="",this.tmpapiparams.deployunitname="",this.tmpapiparams.apiname="",this.tmpapiparams.propertytype="",this.tmpapiparams.deployunitid="",this.tmpapiparams.creator=this.name},addapiparams:function(){var a=this;this.$refs.tmpapiparams.validate(function(t){t&&(a.btnLoading=!0,a.tmpapiparams.keyname=a.tmpapiparams.keyname.trim(),a.tmpapiparams.keynamebak=a.tmpapiparams.keyname,Object(n.b)(a.tmpapiparams).then(function(){a.$message.success("添加成功"),a.getapiparamsList(),a.dialogFormVisible=!1,a.btnLoading=!1}).catch(function(t){a.$message.error("添加失败"),a.btnLoading=!1}))})},showUpdateapiparamsDialog:function(a){this.dialogFormVisible=!0,this.dialogStatus="update",this.tmpapiparams.id=this.apiparamsList[a].id,this.tmpapiparams.deployunitname=this.apiparamsList[a].deployunitname,this.tmpapiparams.apiname=this.apiparamsList[a].apiname,this.tmpapiparams.keyname=this.apiparamsList[a].keynamebak,this.tmpapiparams.keynamebak=this.apiparamsList[a].keynamebak,this.tmpapiparams.deployunitname=this.apiparamsList[a].deployunitname,this.tmpapiparams.propertytype=this.apiparamsList[a].propertytype,this.tmpapiparams.creator=this.name;for(var t=0;t<this.deployunitList.length;t++)this.deployunitList[t].deployunitname===this.tmpapiparams.deployunitname&&(this.tmpapiparams.deployunitid=this.deployunitList[t].id);"Body"===this.tmpapiparams.propertytype?this.paralabel="参数(支持Json，Xml)":this.paralabel="参数(英文逗号隔开)"},updateapiparams:function(){var a=this;this.$refs.tmpapiparams.validate(function(t){t&&Object(n.i)(a.tmpapiparams).then(function(){a.$message.success("更新成功"),a.getapiparamsList(),a.dialogFormVisible=!1}).catch(function(t){a.$message.error("添加失败"),a.btnLoading=!1})})},removeapiparams:function(a){var t=this;this.$confirm("删除该apiparams？","警告",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(function(){var e=t.apiparamsList[a].id;Object(n.e)(e).then(function(){t.$message.success("删除成功"),t.getapiparamsList()})}).catch(function(){t.$message.info("已取消删除")})},isUniqueDetail:function(a){for(var t=0;t<this.apiparamsList.length;t++)if(this.apiparamsList[t].id!==a.id&&this.apiparamsList[t].apiname===a.apiname&&this.apiparamsList[t].propertytype===a.propertytype)return this.$message.error("api参数类型已存在"),!1;return!0}}},u={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"app-container"},[e("div",{staticClass:"filter-container"},[e("el-form",{attrs:{inline:!0}},[e("el-form-item",[a.hasPermission("apiparams:list")?e("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-refresh"},nativeOn:{click:function(t){return t.preventDefault(),a.getapiparamsList(t)}}},[a._v("刷新")]):a._e(),a._v(" "),a.hasPermission("apiparams:add")?e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},nativeOn:{click:function(t){return t.preventDefault(),a.showAddapiparamsDialog(t)}}},[a._v("添加api参数")]):a._e()],1),a._v(" "),a.hasPermission("apiparams:search")?e("span",[e("el-form-item",[e("el-select",{attrs:{placeholder:"发布单元"},on:{change:function(t){return a.selectChanged(t)}},model:{value:a.search.deployunitname,callback:function(t){a.$set(a.search,"deployunitname",t)},expression:"search.deployunitname"}},[e("el-option",{attrs:{label:"请选择",value:""}}),a._v(" "),a._l(a.deployunitList,function(a,t){return e("div",{key:t},[e("el-option",{attrs:{label:a.deployunitname,value:a.deployunitname}})],1)})],2)],1),a._v(" "),e("el-form-item",[e("el-select",{attrs:{placeholder:"api名"},model:{value:a.search.apiname,callback:function(t){a.$set(a.search,"apiname",t)},expression:"search.apiname"}},[e("el-option",{attrs:{label:"请选择",value:""}}),a._v(" "),a._l(a.apiList,function(a,t){return e("div",{key:t},[e("el-option",{attrs:{label:a.apiname,value:a.apiname}})],1)})],2)],1),a._v(" "),e("el-form-item",[e("el-button",{attrs:{type:"primary",loading:a.btnLoading},on:{click:a.searchBy}},[a._v("查询")])],1)],1):a._e()],1)],1),a._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:a.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:a.itemKey,attrs:{data:a.apiparamsList,"element-loading-text":"loading",border:"",fit:"","highlight-current-row":""}},[e("el-table-column",{attrs:{label:"编号",align:"center",width:"60"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("span",{domProps:{textContent:a._s(a.getIndex(t.$index))}})]}}])}),a._v(" "),e("el-table-column",{attrs:{label:"api名",align:"center",prop:"apiname",width:"180"}}),a._v(" "),e("el-table-column",{attrs:{label:"属性类型",align:"center",prop:"propertytype",width:"80"}}),a._v(" "),e("el-table-column",{attrs:{label:"发布单元",align:"center",prop:"deployunitname",width:"130"}}),a._v(" "),e("el-table-column",{attrs:{label:"参数名",align:"center",prop:"keynamebak",width:"100"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("el-popover",{attrs:{trigger:"hover",placement:"top"}},[e("p",[a._v(a._s(t.row.keynamebak))]),a._v(" "),e("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[e("el-tag",{attrs:{size:"medium"}},[a._v("...")])],1)])]}}])}),a._v(" "),e("el-table-column",{attrs:{label:"操作人",align:"center",prop:"creator",width:"100"}}),a._v(" "),e("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime",width:"160"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(a._s(a.unix2CurrentTime(t.row.createTime)))]}}])}),a._v(" "),e("el-table-column",{attrs:{label:"最后修改时间",align:"center",prop:"lastmodifyTime",width:"160"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(a._s(a.unix2CurrentTime(t.row.lastmodifyTime))+"\n      ")]}}])}),a._v(" "),a.hasPermission("apiparams:update")||a.hasPermission("apiparams:delete")?e("el-table-column",{attrs:{label:"管理",align:"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[a.hasPermission("apiparams:update")&&t.row.id!==a.id?e("el-button",{attrs:{type:"warning",size:"mini"},nativeOn:{click:function(e){return e.preventDefault(),a.showUpdateapiparamsDialog(t.$index)}}},[a._v("修改")]):a._e(),a._v(" "),a.hasPermission("apiparams:delete")&&t.row.id!==a.id?e("el-button",{attrs:{type:"danger",size:"mini"},nativeOn:{click:function(e){return e.preventDefault(),a.removeapiparams(t.$index)}}},[a._v("删除")]):a._e()]}}],null,!1,1473501382)}):a._e()],1),a._v(" "),e("el-pagination",{attrs:{"current-page":a.search.page,"page-size":a.search.size,total:a.total,"page-sizes":[10,20,30,40],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}}),a._v(" "),e("el-dialog",{attrs:{title:a.textMap[a.dialogStatus],visible:a.dialogFormVisible},on:{"update:visible":function(t){a.dialogFormVisible=t}}},[e("el-form",{ref:"tmpapiparams",staticClass:"small-space",staticStyle:{width:"600px","margin-left":"30px"},attrs:{"status-icon":"","label-position":"left","label-width":"180px",model:a.tmpapiparams}},[e("el-form-item",{attrs:{label:"发布单元",prop:"deployunitname",required:""}},[e("el-select",{attrs:{placeholder:"发布单元"},on:{change:function(t){return a.paramdeployselectChanged(t)}},model:{value:a.tmpapiparams.deployunitname,callback:function(t){a.$set(a.tmpapiparams,"deployunitname",t)},expression:"tmpapiparams.deployunitname"}},[e("el-option",{staticStyle:{display:"none"},attrs:{label:"请选择",value:"''"}}),a._v(" "),a._l(a.deployunitList,function(a,t){return e("div",{key:t},[e("el-option",{attrs:{label:a.deployunitname,value:a.deployunitname,required:""}})],1)})],2)],1),a._v(" "),e("el-form-item",{attrs:{label:"api",prop:"apiname",required:""}},[e("el-select",{attrs:{placeholder:"api"},on:{change:function(t){return a.apinameselectChanged(t)}},model:{value:a.tmpapiparams.apiname,callback:function(t){a.$set(a.tmpapiparams,"apiname",t)},expression:"tmpapiparams.apiname"}},[e("el-option",{attrs:{label:"请选择",value:""}}),a._v(" "),a._l(a.paramsapiList,function(a,t){return e("div",{key:t},[e("el-option",{attrs:{label:a.apiname,value:a.apiname}})],1)})],2)],1),a._v(" "),e("el-form-item",{attrs:{label:"参数类型",prop:"propertytype",required:""}},[e("el-select",{attrs:{placeholder:"参数类型"},on:{change:function(t){return a.paratypeselectChanged(t)}},model:{value:a.tmpapiparams.propertytype,callback:function(t){a.$set(a.tmpapiparams,"propertytype",t)},expression:"tmpapiparams.propertytype"}},[e("el-option",{staticStyle:{display:"none"},attrs:{label:"请选择",value:"''"}}),a._v(" "),a._l(a.paramlist,function(a,t){return e("div",{key:t},[e("el-option",{attrs:{label:a.value,value:a.value}})],1)})],2)],1),a._v(" "),e("el-form-item",{attrs:{label:a.paralabel,prop:"keyname",required:""}},[e("el-input",{attrs:{type:"textarea",rows:"10",cols:"50",maxlength:"2000","prefix-icon":"el-icon-message","auto-complete":"off",placeholder:a.keyholder},model:{value:a.tmpapiparams.keyname,callback:function(t){a.$set(a.tmpapiparams,"keyname","string"==typeof t?t.trim():t)},expression:"tmpapiparams.keyname"}})],1)],1),a._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{nativeOn:{click:function(t){t.preventDefault(),a.dialogFormVisible=!1}}},[a._v("取消")]),a._v(" "),"add"===a.dialogStatus?e("el-button",{attrs:{type:"danger"},nativeOn:{click:function(t){return t.preventDefault(),a.$refs.tmpapiparams.resetFields()}}},[a._v("重置")]):a._e(),a._v(" "),"add"===a.dialogStatus?e("el-button",{attrs:{type:"success",loading:a.btnLoading},nativeOn:{click:function(t){return t.preventDefault(),a.addapiparams(t)}}},[a._v("添加")]):a._e(),a._v(" "),"update"===a.dialogStatus?e("el-button",{attrs:{type:"success",loading:a.btnLoading},nativeOn:{click:function(t){return t.preventDefault(),a.updateapiparams(t)}}},[a._v("修改")]):a._e()],1)],1)],1)},staticRenderFns:[]},c=e("VU/8")(m,u,!1,null,null,null);t.default=c.exports}});
//# sourceMappingURL=40.7961cb73b21aee35d011.js.map