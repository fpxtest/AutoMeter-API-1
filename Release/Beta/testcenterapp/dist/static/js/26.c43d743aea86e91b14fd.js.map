{"version":3,"sources":["webpack:///src/views/system/role/list.vue","webpack:///./src/views/system/role/list.vue?b621","webpack:///./src/views/system/role/list.vue"],"names":["list","created","this","hasPermission","getPermissionList","getRoleList","data","roleList","permissionList","listLoading","total","listQuery","page","size","dialogStatus","dialogFormVisible","textMap","update","add","btnLoading","tempRole","id","name","permissionIdList","createRules","required","trigger","validator","rule","value","callback","Error","computed","extends_default","Object","vuex_esm","methods","unix2CurrentTime","utils","_this","role","then","response","catch","res","$message","error","_this2","handleSizeChange","handleCurrentChange","getTableIndex","index","showAddRoleDialog","showUpdateRoleDialog","i","resourceList","length","handleList","j","handle","push","showRoleDialog","addRole","_this3","$refs","validate","valid","isRoleNameUnique","success","console","log","updateRole","_this4","removeRole","_this5","$confirm","confirmButtonText","cancelButtonText","type","roleId","info","isMenuNone","indexOf","isMenuAll","checkAll","cancelAll","selectAll","addUnique","idIndex","splice","handleChecked","item","makePermissionChecked","val","arr","role_list","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","inline","icon","nativeOn","click","$event","preventDefault","_v","_e","directives","rawName","expression","modifiers","body","element-loading-text","border","fit","highlight-current-row","label","align","width","scopedSlots","_u","key","fn","scope","domProps","textContent","_s","$index","prop","row","current-page","page-size","page-sizes","layout","on","size-change","current-change","title","visible","update:visible","ref","staticStyle","margin-left","status-icon","label-position","label-width","model","rules","disabled","prefix-icon","auto-complete","$$v","$set","_l","permission","resource","change","_index","slot","loading","staticRenderFns","Component","__webpack_require__","normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/26.c43d743aea86e91b14fd.js","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"filter-container\">\n      <el-form :inline=\"true\">\n        <el-form-item>\n          <el-button\n            type=\"success\"\n            size=\"mini\"\n            icon=\"el-icon-refresh\"\n            v-if=\"hasPermission('role:list')\"\n            @click.native.prevent=\"getRoleList\"\n          >刷新</el-button>\n          <el-button\n            type=\"primary\"\n            size=\"mini\"\n            icon=\"el-icon-plus\"\n            v-if=\"hasPermission('role:add')\"\n            @click.native.prevent=\"showAddRoleDialog\"\n          >添加角色</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <el-table\n      :data=\"roleList\"\n      v-loading.body=\"listLoading\"\n      element-loading-text=\"loading\"\n      border\n      fit\n      highlight-current-row\n    >\n      <el-table-column label=\"#\" align=\"center\" width=\"80\">\n        <template slot-scope=\"scope\">\n          <span v-text=\"getTableIndex(scope.$index)\"></span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"角色名\" align=\"center\" prop=\"name\" />\n      <el-table-column\n        label=\"管理\"\n        align=\"center\"\n        v-if=\"hasPermission('role:detail') || hasPermission('role:update') || hasPermission('role:delete')\"\n      >\n        <template slot-scope=\"scope\">\n          <el-button\n            type=\"info\"\n            size=\"mini\"\n            v-if=\"hasPermission('role:detail')\"\n            @click.native.prevent=\"showRoleDialog(scope.$index)\"\n          >查看</el-button>\n          <el-button\n            type=\"warning\"\n            size=\"mini\"\n            v-if=\"hasPermission('role:update') && scope.row.name !== '超级管理员'\"\n            @click.native.prevent=\"showUpdateRoleDialog(scope.$index)\"\n          >修改</el-button>\n          <el-button\n            type=\"danger\"\n            size=\"mini\"\n            v-if=\"hasPermission('role:delete') && scope.row.name !== '超级管理员'\"\n            @click.native.prevent=\"removeRole(scope.$index)\"\n          >删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-pagination\n      @size-change=\"handleSizeChange\"\n      @current-change=\"handleCurrentChange\"\n      :current-page=\"listQuery.page\"\n      :page-size=\"listQuery.size\"\n      :total=\"total\"\n      :page-sizes=\"[9, 18, 36, 72]\"\n      layout=\"total, sizes, prev, pager, next, jumper\"\n    ></el-pagination>\n\n    <el-dialog :title=\"textMap[dialogStatus]\" :visible.sync=\"dialogFormVisible\">\n      <el-form\n        status-icon\n        class=\"small-space\"\n        label-position=\"left\"\n        label-width=\"100px\"\n        style=\"width: 500px; margin-left:50px;\"\n        :model=\"tempRole\"\n        :rules=\"createRules\"\n        ref=\"tempRole\"\n      >\n        <el-form-item label=\"角色名\" prop=\"name\" required>\n          <el-input\n            :disabled=\"dialogStatus === 'show'\"\n            type=\"text\"\n            prefix-icon=\"el-icon-edit\"\n            auto-complete=\"off\"\n            v-model=\"tempRole.name\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item label=\"权限\" required>\n          <div v-for=\"(permission, index) in permissionList\" :key=\"index\">\n            <el-button\n              :disabled=\"dialogStatus === 'show'\"\n              size=\"mini\"\n              :type=\"isMenuNone(index) ? '' : (isMenuAll(index) ? 'success' : 'primary')\"\n              @click.native.prevent=\"checkAll(index)\"\n            >{{ permission.resource }}</el-button>\n            <!-- https://element.eleme.cn/#/zh-CN/component/checkbox#indeterminate-zhuang-tai -->\n            <el-checkbox-group v-model=\"tempRole.permissionIdList\">\n              <el-checkbox\n                :disabled=\"dialogStatus === 'show'\"\n                v-for=\"item in permission.handleList\"\n                :key=\"item.id\"\n                :label=\"item.id\"\n                @change=\"handleChecked(item, _index)\"\n              >\n                <span>{{ item.handle }}</span>\n              </el-checkbox>\n            </el-checkbox-group>\n          </div>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click.native.prevent=\"dialogFormVisible = false\">取消</el-button>\n        <el-button\n          v-if=\"dialogStatus === 'add'\"\n          type=\"success\"\n          :loading=\"btnLoading\"\n          @click.native.prevent=\"addRole\"\n        >添加</el-button>\n        <el-button\n          v-if=\"dialogStatus === 'update'\"\n          type=\"primary\"\n          :loading=\"btnLoading\"\n          @click.native.prevent=\"updateRole\"\n        >更新</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport {\n  listRoleWithPermission,\n  listResourcePermission,\n  add as addRole,\n  update as updateRole,\n  remove\n} from '@/api/role'\nimport { unix2CurrentTime } from '@/utils'\nimport { mapGetters } from 'vuex'\n\nexport default {\n  created() {\n    if (this.hasPermission('role:update')) {\n      this.getPermissionList()\n    }\n    if (this.hasPermission('role:list')) {\n      this.getRoleList()\n    }\n  },\n  data() {\n    /**\n     * 验证角色名\n     * @param rule 规则\n     * @param value 角色名\n     * @param callback 回调\n     */\n    const validateRoleName = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('角色名不能为空'))\n      } else {\n        callback()\n      }\n    }\n    return {\n      roleList: [],\n      permissionList: [],\n      listLoading: false,\n      total: 0,\n      listQuery: {\n        page: 1,\n        size: 10\n      },\n      dialogStatus: 'add',\n      dialogFormVisible: false,\n      textMap: {\n        update: '修改角色',\n        add: '添加角色'\n      },\n      btnLoading: false,\n      tempRole: {\n        id: '',\n        name: '',\n        permissionIdList: []\n      },\n      createRules: {\n        name: [{ required: true, trigger: 'blur', validator: validateRoleName }]\n      }\n    }\n  },\n  computed: {\n    ...mapGetters(['roleName'])\n  },\n  methods: {\n    unix2CurrentTime,\n    /**\n     * 获取所有角色权限\n     */\n    getPermissionList() {\n      listResourcePermission().then(response => {\n        this.permissionList = response.data.list\n      }).catch(res => {\n        this.$message.error('加载权限列表失败')\n      })\n    },\n    /**\n     * 获取角色列表\n     */\n    getRoleList() {\n      this.listLoading = true\n      listRoleWithPermission(this.listQuery).then(response => {\n        this.roleList = response.data.list\n        this.total = response.data.total\n        this.listLoading = false\n      }).catch(res => {\n        this.$message.error('加载角色列表失败')\n      })\n    },\n    /**\n     * 改变每页数量\n     * @param size 页大小\n     */\n    handleSizeChange(size) {\n      this.listQuery.page = 1\n      this.listQuery.size = size\n      this.getRoleList()\n    },\n    /**\n     * 改变页码\n     * @param page 页号\n     */\n    handleCurrentChange(page) {\n      this.listQuery.page = page\n      this.getRoleList()\n    },\n    /**\n     * 表格序号\n     * @param index 数据下标\n     * @returns 表格序号\n     */\n    getTableIndex(index) {\n      return (this.listQuery.page - 1) * this.listQuery.size + index + 1\n    },\n    /**\n     * 显示新增角色对话框\n     */\n    showAddRoleDialog() {\n      this.dialogFormVisible = true\n      this.dialogStatus = 'add'\n      this.tempRole.name = ''\n      this.tempRole.id = ''\n      this.tempRole.permissionIdList = []\n    },\n    /**\n     * 显示更新角色的对话框\n     * @param index 角色下标\n     */\n    showUpdateRoleDialog(index) {\n      this.dialogFormVisible = true\n      this.dialogStatus = 'update'\n      const role = this.roleList[index]\n      this.tempRole.name = role.name\n      this.tempRole.id = role.id\n      this.tempRole.permissionIdList = []\n      for (let i = 0; i < role.resourceList.length; i++) {\n        const handleList = role.resourceList[i].handleList\n        for (let j = 0; j < handleList.length; j++) {\n          const handle = handleList[j]\n          this.tempRole.permissionIdList.push(handle.id)\n        }\n      }\n    },\n    /**\n     * 显示角色权限的对话框\n     * @param index 角色下标\n     */\n    showRoleDialog(index) {\n      this.dialogFormVisible = true\n      this.dialogStatus = 'show'\n      const role = this.roleList[index]\n      this.tempRole.name = role.name\n      this.tempRole.id = role.id\n      this.tempRole.permissionIdList = []\n      let resourceList = []\n      if (role.name === '超级管理员') {\n        resourceList = this.permissionList\n      } else {\n        resourceList = role.resourceList\n      }\n      for (let i = 0; i < resourceList.length; i++) {\n        const handleList = resourceList[i].handleList\n        for (let j = 0; j < handleList.length; j++) {\n          const handle = handleList[j]\n          this.tempRole.permissionIdList.push(handle.id)\n        }\n      }\n    },\n    /**\n     * 添加新角色\n     */\n    addRole() {\n      this.$refs.tempRole.validate(valid => {\n        if (\n          valid &&\n          this.isRoleNameUnique(this.tempRole.id, this.tempRole.name)\n        ) {\n          this.btnLoading = true\n          addRole(this.tempRole).then(() => {\n            this.$message.success('添加成功')\n            this.getRoleList()\n          }).catch(res => {\n            this.$message.error('添加角色失败')\n          })\n          this.dialogFormVisible = false\n          this.btnLoading = false\n        } else {\n          console.log('表单无效')\n        }\n      })\n    },\n    /**\n     * 修改角色\n     */\n    updateRole() {\n      this.$refs.tempRole.validate(valid => {\n        if (\n          valid &&\n          this.isRoleNameUnique(this.tempRole.id, this.tempRole.name)\n        ) {\n          this.btnLoading = true\n          updateRole(this.tempRole).then(() => {\n            this.$message.success('更新成功')\n            this.getRoleList()\n          }).catch(res => {\n            this.$message.error('更新角色失败')\n          })\n          this.dialogFormVisible = false\n          this.btnLoading = false\n        } else {\n          console.log('表单无效')\n        }\n      })\n    },\n    /**\n     * 校验角色名是否已经存在\n     * @param id 角色id\n     * @param name 角色名\n     * @returns {boolean}\n     */\n    isRoleNameUnique(id, name) {\n      for (let i = 0; i < this.roleList.length; i++) {\n        if (this.roleList[i].id !== id && this.roleList[i].name === name) {\n          this.$message.error('角色名已存在')\n          return false\n        }\n      }\n      return true\n    },\n    /**\n     * 移除角色\n     * @param index 角色下标\n     * @returns {boolean}\n     */\n    removeRole(index) {\n      this.$confirm('删除该角色？', '警告', {\n        confirmButtonText: '是',\n        cancelButtonText: '否',\n        type: 'warning'\n      }).then(() => {\n        const roleId = this.roleList[index].id\n        remove(roleId).then(() => {\n          this.$message.success('删除成功')\n          this.getRoleList()\n        }).catch(() => {\n          this.$message.error('删除失败')\n        })\n      }).catch(() => {\n        this.$message.info('已取消删除')\n      })\n    },\n    /**\n     * 判断角色菜单内的权限是否一个都没选\n     * @param index 下标\n     * @returns {boolean}\n     */\n    isMenuNone(index) {\n      const handleList = this.permissionList[index].handleList\n      for (let i = 0; i < handleList.length; i++) {\n        if (this.tempRole.permissionIdList.indexOf(handleList[i].id) > -1) {\n          return false\n        }\n      }\n      return true\n    },\n    /**\n     * 判断角色菜单内的权限是否全选了\n     * @param index 下标\n     * @returns {boolean}\n     */\n    isMenuAll(index) {\n      const handleList = this.permissionList[index].handleList\n      for (let i = 0; i < handleList.length; i++) {\n        if (this.tempRole.permissionIdList.indexOf(handleList[i].id) < 0) {\n          return false\n        }\n      }\n      return true\n    },\n    /**\n     * 根据菜单状态check所有checkbox\n     * @param index 下标\n     */\n    checkAll(index) {\n      if (this.isMenuAll(index)) {\n        // 如果已经全选了,则全部取消\n        this.cancelAll(index)\n      } else {\n        // 如果尚未全选,则全选\n        this.selectAll(index)\n      }\n    },\n    /**\n     * checkbox全部选中\n     * @param index 下标\n     */\n    selectAll(index) {\n      const handleList = this.permissionList[index].handleList\n      for (let i = 0; i < handleList.length; i++) {\n        this.addUnique(handleList[i].id, this.tempRole.permissionIdList)\n      }\n    },\n    /**\n     * checkbox全部取消选中\n     * @param index 下标\n     */\n    cancelAll(index) {\n      const handleList = this.permissionList[index].handleList\n      for (let i = 0; i < handleList.length; i++) {\n        const idIndex = this.tempRole.permissionIdList.indexOf(handleList[i].id)\n        if (idIndex > -1) {\n          this.tempRole.permissionIdList.splice(idIndex, 1)\n        }\n      }\n    },\n    /**\n     * 本方法会在勾选状态改变之后触发\n     * @param item 选项\n     * @param index 对应下标\n     */\n    handleChecked(item, index) {\n      if (this.tempRole.permissionIdList.indexOf(item.id) > -1) {\n        // 选中事件\n        // 如果之前未勾选本权限,现在勾选完之后,tempRole里就会包含本id\n        // 那么就要将必选的权限勾上\n        this.makePermissionChecked(index)\n      } else {\n        // 取消选中事件\n        this.cancelAll(index)\n      }\n    },\n    /**\n     * 将角色菜单必选的权限勾上（这里并没有做必选的数据库字段）\n     * @param index 权限对应下标\n     */\n    makePermissionChecked(index) {\n      const handleList = this.permissionList[index].handleList\n      for (let i = 0; i < handleList.length; i++) {\n        this.addUnique(handleList[i].id, this.tempRole.permissionIdList)\n      }\n    },\n    /**\n     * 数组内防重复地添加元素\n     * @param val 值\n     * @param arr 数组\n     */\n    addUnique(val, arr) {\n      const _index = arr.indexOf(val)\n      if (_index < 0) {\n        arr.push(val)\n      }\n    }\n  }\n}\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/views/system/role/list.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"app-container\"},[_c('div',{staticClass:\"filter-container\"},[_c('el-form',{attrs:{\"inline\":true}},[_c('el-form-item',[(_vm.hasPermission('role:list'))?_c('el-button',{attrs:{\"type\":\"success\",\"size\":\"mini\",\"icon\":\"el-icon-refresh\"},nativeOn:{\"click\":function($event){$event.preventDefault();return _vm.getRoleList($event)}}},[_vm._v(\"刷新\")]):_vm._e(),_vm._v(\" \"),(_vm.hasPermission('role:add'))?_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\",\"icon\":\"el-icon-plus\"},nativeOn:{\"click\":function($event){$event.preventDefault();return _vm.showAddRoleDialog($event)}}},[_vm._v(\"添加角色\")]):_vm._e()],1)],1)],1),_vm._v(\" \"),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading.body\",value:(_vm.listLoading),expression:\"listLoading\",modifiers:{\"body\":true}}],attrs:{\"data\":_vm.roleList,\"element-loading-text\":\"loading\",\"border\":\"\",\"fit\":\"\",\"highlight-current-row\":\"\"}},[_c('el-table-column',{attrs:{\"label\":\"#\",\"align\":\"center\",\"width\":\"80\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',{domProps:{\"textContent\":_vm._s(_vm.getTableIndex(scope.$index))}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"角色名\",\"align\":\"center\",\"prop\":\"name\"}}),_vm._v(\" \"),(_vm.hasPermission('role:detail') || _vm.hasPermission('role:update') || _vm.hasPermission('role:delete'))?_c('el-table-column',{attrs:{\"label\":\"管理\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(_vm.hasPermission('role:detail'))?_c('el-button',{attrs:{\"type\":\"info\",\"size\":\"mini\"},nativeOn:{\"click\":function($event){$event.preventDefault();return _vm.showRoleDialog(scope.$index)}}},[_vm._v(\"查看\")]):_vm._e(),_vm._v(\" \"),(_vm.hasPermission('role:update') && scope.row.name !== '超级管理员')?_c('el-button',{attrs:{\"type\":\"warning\",\"size\":\"mini\"},nativeOn:{\"click\":function($event){$event.preventDefault();return _vm.showUpdateRoleDialog(scope.$index)}}},[_vm._v(\"修改\")]):_vm._e(),_vm._v(\" \"),(_vm.hasPermission('role:delete') && scope.row.name !== '超级管理员')?_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"mini\"},nativeOn:{\"click\":function($event){$event.preventDefault();return _vm.removeRole(scope.$index)}}},[_vm._v(\"删除\")]):_vm._e()]}}],null,false,1195019917)}):_vm._e()],1),_vm._v(\" \"),_c('el-pagination',{attrs:{\"current-page\":_vm.listQuery.page,\"page-size\":_vm.listQuery.size,\"total\":_vm.total,\"page-sizes\":[9, 18, 36, 72],\"layout\":\"total, sizes, prev, pager, next, jumper\"},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}}),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":_vm.textMap[_vm.dialogStatus],\"visible\":_vm.dialogFormVisible},on:{\"update:visible\":function($event){_vm.dialogFormVisible=$event}}},[_c('el-form',{ref:\"tempRole\",staticClass:\"small-space\",staticStyle:{\"width\":\"500px\",\"margin-left\":\"50px\"},attrs:{\"status-icon\":\"\",\"label-position\":\"left\",\"label-width\":\"100px\",\"model\":_vm.tempRole,\"rules\":_vm.createRules}},[_c('el-form-item',{attrs:{\"label\":\"角色名\",\"prop\":\"name\",\"required\":\"\"}},[_c('el-input',{attrs:{\"disabled\":_vm.dialogStatus === 'show',\"type\":\"text\",\"prefix-icon\":\"el-icon-edit\",\"auto-complete\":\"off\"},model:{value:(_vm.tempRole.name),callback:function ($$v) {_vm.$set(_vm.tempRole, \"name\", $$v)},expression:\"tempRole.name\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"权限\",\"required\":\"\"}},_vm._l((_vm.permissionList),function(permission,index){return _c('div',{key:index},[_c('el-button',{attrs:{\"disabled\":_vm.dialogStatus === 'show',\"size\":\"mini\",\"type\":_vm.isMenuNone(index) ? '' : (_vm.isMenuAll(index) ? 'success' : 'primary')},nativeOn:{\"click\":function($event){$event.preventDefault();return _vm.checkAll(index)}}},[_vm._v(_vm._s(permission.resource))]),_vm._v(\" \"),_c('el-checkbox-group',{model:{value:(_vm.tempRole.permissionIdList),callback:function ($$v) {_vm.$set(_vm.tempRole, \"permissionIdList\", $$v)},expression:\"tempRole.permissionIdList\"}},_vm._l((permission.handleList),function(item){return _c('el-checkbox',{key:item.id,attrs:{\"disabled\":_vm.dialogStatus === 'show',\"label\":item.id},on:{\"change\":function($event){return _vm.handleChecked(item, _vm._index)}}},[_c('span',[_vm._v(_vm._s(item.handle))])])}),1)],1)}),0)],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{nativeOn:{\"click\":function($event){$event.preventDefault();_vm.dialogFormVisible = false}}},[_vm._v(\"取消\")]),_vm._v(\" \"),(_vm.dialogStatus === 'add')?_c('el-button',{attrs:{\"type\":\"success\",\"loading\":_vm.btnLoading},nativeOn:{\"click\":function($event){$event.preventDefault();return _vm.addRole($event)}}},[_vm._v(\"添加\")]):_vm._e(),_vm._v(\" \"),(_vm.dialogStatus === 'update')?_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.btnLoading},nativeOn:{\"click\":function($event){$event.preventDefault();return _vm.updateRole($event)}}},[_vm._v(\"更新\")]):_vm._e()],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-0c18d4f9\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/system/role/list.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./list.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./list.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0c18d4f9\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./list.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/system/role/list.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}