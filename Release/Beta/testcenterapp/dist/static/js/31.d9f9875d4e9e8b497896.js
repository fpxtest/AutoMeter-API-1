webpackJsonp([31],{"weF/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),l=a("vLgD");function r(e){return Object(l.a)({url:"/testvariables/value/search",method:"post",data:e})}var n=a("0xDb"),v=a("NYxO"),u={filters:{statusFilter:function(e){return{published:"success",draft:"gray",deleted:"danger"}[e]}},data:function(){return{itemKey:null,tmptestvariablesvaluename:"",testvariablesvalueList:[],listLoading:!1,total:0,dialogStatus:"add",dialogFormVisible:!1,textMap:{updateRole:"修改环境",update:"修改环境",add:"添加环境"},btnLoading:!1,tmptestvariablesvalue:{id:"",planname:"",batchname:"",casename:"",variablesname:"",variablesvalue:"",memo:"",creator:""},search:{page:1,size:10,testvariablesvaluename:null}}},created:function(){this.gettestvariablesvalueList()},computed:i()({},Object(v.b)(["name","sidebar","avatar"])),methods:{unix2CurrentTime:n.b,gettestvariablesvalueList:function(){var e=this;this.listLoading=!0,this.search.testvariablesvaluename=this.tmptestvariablesvaluename,r(this.search).then(function(t){e.testvariablesvalueList=t.data.list,e.total=t.data.total,e.listLoading=!1}).catch(function(t){e.$message.error("加载环境列表失败")})},searchBy:function(){var e=this;this.search.page=1,this.listLoading=!0,r(this.search).then(function(t){e.itemKey=Math.random(),e.testvariablesvalueList=t.data.list,e.total=t.data.total}).catch(function(t){e.$message.error("搜索失败")}),this.tmptestvariablesvaluename=this.search.testvariablesvaluename,this.listLoading=!1,this.btnLoading=!1},handleSizeChange:function(e){this.search.page=1,this.search.size=e,this.gettestvariablesvalueList()},handleCurrentChange:function(e){this.search.page=e,this.gettestvariablesvalueList()},getIndex:function(e){return(this.search.page-1)*this.search.size+e+1},showAddtestvariablesvalueDialog:function(){this.dialogFormVisible=!0,this.dialogStatus="add",this.tmptestvariablesvalue.id="",this.tmptestvariablesvalue.testvariablesvaluename="",this.tmptestvariablesvalue.variablesdes="",this.tmptestvariablesvalue.testvariablesvaluetype="",this.tmptestvariablesvalue.variablesexpress="",this.tmptestvariablesvalue.memo="",this.tmptestvariablesvalue.envtype="",this.tmptestvariablesvalue.creator=this.name},addtestvariablesvalue:function(){var e=this;this.$refs.tmptestvariablesvalue.validate(function(t){var a;t&&(e.btnLoading=!0,(a=e.tmptestvariablesvalue,Object(l.a)({url:"/testvariables/value",method:"post",data:a})).then(function(){e.$message.success("添加成功"),e.gettestvariablesvalueList(),e.dialogFormVisible=!1,e.btnLoading=!1}).catch(function(t){e.$message.error("添加失败"),e.btnLoading=!1}))})},showUpdatetestvariablesvalueDialog:function(e){this.dialogFormVisible=!0,this.dialogStatus="update",this.tmptestvariablesvalue.id=this.testvariablesvalueList[e].id,this.tmptestvariablesvalue.testvariablesvaluename=this.testvariablesvalueList[e].testvariablesvaluename,this.tmptestvariablesvalue.variablesdes=this.testvariablesvalueList[e].variablesdes,this.tmptestvariablesvalue.testvariablesvaluetype=this.testvariablesvalueList[e].testvariablesvaluetype,this.tmptestvariablesvalue.variablesexpress=this.testvariablesvalueList[e].variablesexpress,this.tmptestvariablesvalue.memo=this.testvariablesvalueList[e].memo,this.tmptestvariablesvalue.creator=this.name},updatetestvariablesvalue:function(){var e=this;this.$refs.tmptestvariablesvalue.validate(function(t){var a;t&&(a=e.tmptestvariablesvalue,Object(l.a)({url:"/testvariables/value/detail",method:"put",data:a})).then(function(){e.$message.success("更新成功"),e.gettestvariablesvalueList(),e.dialogFormVisible=!1}).catch(function(t){e.$message.error("更新失败")})})},removetestvariablesvalue:function(e){var t=this;this.$confirm("删除该变量？","警告",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(function(){var a,s=t.testvariablesvalueList[e].id;(a=s,Object(l.a)({url:"/testvariables/value/"+a,method:"delete"})).then(function(){t.$message.success("删除成功"),t.gettestvariablesvalueList()})}).catch(function(){t.$message.info("已取消删除")})},isUniqueDetail:function(e){for(var t=0;t<this.testvariablesvalueList.length;t++)if(this.testvariablesvalueList[t].id!==e.id&&this.testvariablesvalueList[t].testvariablesvaluename===e.testvariablesvaluename)return this.$message.error("变量名已存在"),!1;return!0}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[e.hasPermission("testvariablesvalue:list")?a("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-refresh"},nativeOn:{click:function(t){return t.preventDefault(),e.gettestvariablesvalueList(t)}}},[e._v("刷新")]):e._e()],1),e._v(" "),e.hasPermission("testvariablesvalue:search")?a("span",[a("el-form-item",[a("el-input",{attrs:{clearable:"",maxlength:"40",placeholder:"变量名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchBy(t)}},model:{value:e.search.testvariablesvaluename,callback:function(t){e.$set(e.search,"testvariablesvaluename",t)},expression:"search.testvariablesvaluename"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:e.searchBy}},[e._v("查询")])],1)],1):e._e()],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.itemKey,attrs:{data:e.testvariablesvalueList,"element-loading-text":"loading",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"编号",align:"center",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{textContent:e._s(e.getIndex(t.$index))}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"测试集合",align:"center",prop:"planname",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"执行计划",align:"center",prop:"batchname",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"测试用例",align:"center",prop:"casename",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"变量名",align:"center",prop:"variablesname",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"变量值",align:"center",prop:"variablesvalue",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v(e._s(t.row.variablesvalue))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v("...")])],1)])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.unix2CurrentTime(t.row.createTime)))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"最后修改时间",align:"center",prop:"lastmodifyTime",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.unix2CurrentTime(t.row.lastmodifyTime))+"\n      ")]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.search.page,"page-size":e.search.size,total:e.total,"page-sizes":[10,20,30,40],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]},c=a("VU/8")(u,o,!1,null,null,null);t.default=c.exports}});
//# sourceMappingURL=31.d9f9875d4e9e8b497896.js.map